<!DOCTYPE html>
<html lang="en">
  <head>
    <style>
      .recipe-card,
      .user-card {
        margin-bottom: 20px;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
      }

      .btn-action {
        margin: 5px;
      }

      .nav-tabs {
        border-bottom: 2px solid #ddd;
        margin: 20px auto;
        display: flex;
        justify-content: center;
        width: 90%;
        max-width: 800px;
      }

      .nav-tabs .nav-item {
        margin: 0 5px;
      }

      .nav-tabs .nav-link {
        border: 2px solid transparent;
        border-radius: 8px 8px 0 0;
        padding: 12px 20px;
        font-weight: 600;
        color: #555;
        transition: all 0.3s ease;
        background-color: #f8f9fa;
      }

      .nav-tabs .nav-link.active {
        color: #495057;
        background-color: #fff;
        border-color: #ddd #ddd #fff;
        border-bottom: 3px solid #dc3545;
        transform: translateY(-1px);
      }

      .tab-content {
        width: 90%;
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
        background: #fff;
        border: 1px solid #ddd;
        border-top: none;
        border-radius: 0 0 8px 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        min-height: 400px;
        position: relative;
      }

      .recipe-card {
        display: flex;
        gap: 20px;
        align-items: flex-start;
        margin-bottom: 20px;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: #f9f9f9;
      }

      .recipe-image {
        flex: 0 0 170px;
      }
      .recipe-image img {
        width: 170px;
        height: 120px;
        object-fit: cover;
        border-radius: 8px;
        border: 2px solid #ddd;
      }
      .no-image {
        width: 170px;
        height: 120px;
        background: #f0f0f0;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        color: #666;
        font-style: italic;
        border: 2px solid #eee;
      }

      .recipe-details {
        flex: 1;
      }

      .meta-row {
        display: flex;
        gap: 18px;
        flex-wrap: wrap;
        align-items: center;
      }
      .meta-row p {
        margin: 0;
        color: #555;
        font-size: 14px;
      }
      .card-actions {
        text-align: right;
      }
      .section-heading {
        margin-bottom: 8px;
      }

      /* Fix for the awkward gap */
      .navbar {
        margin-bottom: 0;
      }
      .container:first-of-type {
        padding-top: 20px;
      }
      .panel.panel-danger {
        margin-bottom: 0;
      }
      hr {
        margin-top: 10px;
        margin-bottom: 10px;
      }

      /* Default message styling */
      .default-message {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 200px;
        color: #666;
        font-size: 18px;
      }

      /* Hide default message when tabs are active */
      .tab-pane.active ~ .default-message,
      .tab-content:has(.tab-pane.active) .default-message {
        display: none;
      }
    </style>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>TastyShare - Manage Feedbacks</title>

    <!-- Bootstrap -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='assets/css/bootstrap.css') }}"
    />
  </head>
  <body>
    {% include "includes/admin_navbar.html" %}

    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="panel panel-danger">
            <div class="panel-heading text-center">
              <h4>
                <span class="glyphicon glyphicon-th-list"></span>
                &nbsp; Manage Feedbacks
              </h4>
            </div>
            <div class="panel-body text-center">
              <h4>
                <strong>Welcome, {{ session.username.capitalize() }}!</strong>
                Manage Feedbacks below.
              </h4>
            </div>
          </div>
        </div>
      </div>
      <hr />
    </div>

    <!-- Tab Container -->
    <div class="container">
      <div class="row">
        <div class="col-xs-12">
          <!-- Tab Navigation -->
          <ul class="nav nav-tabs" id="recipeTabs" role="tablist">
            <li class="nav-item">
              <a
                class="nav-link"
                id="feedbacks-tab"
                data-toggle="tab"
                href="#feedbacks"
                role="tab"
                aria-controls="feedbacks"
                aria-selected="false"
                >ðŸ’¬ Feedbacks ({{ feedbacks|length }})</a
              >
            </li>
          </ul>

          <!-- Tab Content -->
          <div class="tab-content" id="recipeTabsContent">
            <!-- Default message -->
            <div class="default-message text-center py-4">
              <p class="text-muted">ðŸ‘† Click tab to view content.</p>
            </div>

            <!-- Feedbacks Tab -->
            <div
              class="tab-pane fade"
              id="feedbacks"
              role="tabpanel"
              aria-labelledby="feedbacks-tab"
            >
              <h3 class="section-heading">ðŸ’¬ User Feedbacks</h3>
              {% if feedbacks %} {% for fb in feedbacks %}
              <div class="recipe-card">
                <div class="recipe-details">
                  <h4 style="margin-top: 0">
                    <strong>{{ fb.username }}</strong>
                  </h4>
                  <div class="meta-row">
                    <p><strong>Email:</strong> {{ fb.email }}</p>
                    <p>
                      <strong>Date:</strong> {{ fb.created_at.strftime('%Y-%m-%d
                      %H:%M') if fb.created_at else '' }}
                    </p>
                  </div>
                  <p style="margin-top: 8px">
                    <strong>Message:</strong> {{ fb.message }}
                  </p>
                </div>
              </div>
              {% endfor %} {% else %}
              <div class="well well-info mt-3">
                <p>No feedbacks yet.</p>
              </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>

    <hr />
    <div class="container well">
      <div class="row">
        <div class="col-xs-6 col-sm-6 col-lg-4 col-md-4">
          <h3>About Us</h3>
          <hr />
          <p></p>
        </div>
        <div class="col-xs-6 col-sm-6 col-lg-4 col-md-4 hidden-sm hidden-xs">
          <h3>Latest News</h3>
          <hr />
        </div>
        <div class="col-xs-6 col-sm-6 col-lg-4 col-md-4">
          <h3>Contact Us</h3>
          <hr />
        </div>
      </div>
    </div>

    <footer class="text-center">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <p>TastyShare.</p>
          </div>
        </div>
      </div>
    </footer>

    <script src="{{ url_for('static', filename='assets/js/jquery-1.11.3.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/bootstrap.js') }}"></script>

    <script>
      $(document).ready(function () {
        // Hide default message when any tab is clicked
        $('a[data-toggle="tab"]').on("shown.bs.tab", function () {
          $(".default-message").hide();
        });
      });

      setTimeout(function () {
        const flashes = document.querySelectorAll(".alert");
        flashes.forEach((flash) => {
          flash.style.transition = "opacity 1s ease";
          flash.style.opacity = 0;
          setTimeout(() => flash.remove(), 1000);
        });
      }, 2000);
    </script>
  </body>
</html>
